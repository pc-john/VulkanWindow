#version 450

// LMS response table data
// (2-deg LMS fundamentals based on the Stiles and Burch 10-deg CMFs adjusted to 2-deg,
// downloaded from: http://www.cvrl.org/ciepr.htm in linear energy units, 1nm step,
// 444 values in total, composed of 441 normal values plus one whitepoint
// plus two values to close the horseshoe shape from the bottom
vec3 lms[] =
	vec3[](
		vec3(1.2232, 1, 0.616),  // white point
		vec3(0.000415003, 0.000368349, 0.00954729),  // 390
		vec3(0.00050265, 0.000448015, 0.0114794),  // 391
		vec3(0.000607367, 0.000543965, 0.0137986),  // 392
		vec3(0.00073185, 0.000658983, 0.0165746),  // 393
		vec3(0.000879012, 0.000796121, 0.0198869),  // 394
		vec3(0.00105192, 0.000958658, 0.023825),  // 395
		vec3(0.00125373, 0.00115002, 0.0284877),  // 396
		vec3(0.00148756, 0.00137367, 0.0339832),  // 397
		vec3(0.00175633, 0.00163296, 0.0404274),  // 398
		vec3(0.00206261, 0.00193089, 0.0479417),  // 399
		vec3(0.00240836, 0.00226991, 0.0566498),  // 400
		vec3(0.00279522, 0.0026521, 0.0666757),  // 401
		vec3(0.0032264, 0.0030811, 0.0781479),  // 402
		vec3(0.00370617, 0.00356156, 0.0911925),  // 403
		vec3(0.00423972, 0.004099, 0.105926),  // 404
		vec3(0.00483339, 0.0047001, 0.122451),  // 405
		vec3(0.00549335, 0.00537186, 0.140844),  // 406
		vec3(0.00621933, 0.00611757, 0.16114),  // 407
		vec3(0.00700631, 0.00693795, 0.183325),  // 408
		vec3(0.00784503, 0.00783144, 0.207327),  // 409
		vec3(0.00872127, 0.00879369, 0.233008),  // 410
		vec3(0.00961879, 0.00981865, 0.260183),  // 411
		vec3(0.0105324, 0.0109044, 0.288723),  // 412
		vec3(0.011462, 0.0120509, 0.318512),  // 413
		vec3(0.0124105, 0.0132582, 0.349431),  // 414
		vec3(0.0133837, 0.0145277, 0.381363),  // 415
		vec3(0.014387, 0.01586, 0.414141),  // 416
		vec3(0.0154116, 0.0172496, 0.44735),  // 417
		vec3(0.0164424, 0.0186878, 0.480439),  // 418
		vec3(0.0174614, 0.0201638, 0.512767),  // 419
		vec3(0.018448, 0.0216649, 0.543618),  // 420
		vec3(0.0193852, 0.0231801, 0.572399),  // 421
		vec3(0.0202811, 0.0247139, 0.599284),  // 422
		vec3(0.0211545, 0.0262785, 0.624786),  // 423
		vec3(0.0220286, 0.0278905, 0.649576),  // 424
		vec3(0.0229317, 0.0295714, 0.674474),  // 425
		vec3(0.0238896, 0.0313438, 0.700186),  // 426
		vec3(0.0249026, 0.0332151, 0.72646),  // 427
		vec3(0.0259631, 0.0351889, 0.752726),  // 428
		vec3(0.0270619, 0.0372683, 0.778333),  // 429
		vec3(0.0281877, 0.0394566, 0.802555),  // 430
		vec3(0.0293303, 0.0417546, 0.824818),  // 431
		vec3(0.0304898, 0.0441544, 0.845422),  // 432
		vec3(0.0316694, 0.0466432, 0.864961),  // 433
		vec3(0.0328731, 0.049205, 0.8841),  // 434
		vec3(0.0341054, 0.0518199, 0.903573),  // 435
		vec3(0.035367, 0.0544645, 0.923844),  // 436
		vec3(0.03664, 0.0571131, 0.944055),  // 437
		vec3(0.0378988, 0.0597369, 0.96292),  // 438
		vec3(0.0391148, 0.0623038, 0.979057),  // 439
		vec3(0.0402563, 0.0647782, 0.99102),  // 440
		vec3(0.0412989, 0.0671329, 0.997765),  // 441
		vec3(0.0422582, 0.0693844, 0.999982),  // 442
		vec3(0.0431627, 0.0715658, 0.998861),  // 443
		vec3(0.0440444, 0.0737164, 0.995628),  // 444
		vec3(0.044938, 0.0758812, 0.991515),  // 445
		vec3(0.0458729, 0.078098, 0.987377),  // 446
		vec3(0.0468459, 0.0803538, 0.982619),  // 447
		vec3(0.0478446, 0.0826198, 0.976301),  // 448
		vec3(0.0488555, 0.0848644, 0.967513),  // 449
		vec3(0.0498639, 0.0870524, 0.955393),  // 450
		vec3(0.0508618, 0.089164, 0.939499),  // 451
		vec3(0.0518731, 0.0912523, 0.920807),  // 452
		vec3(0.0529317, 0.093395, 0.900592),  // 453
		vec3(0.0540746, 0.0956775, 0.88004),  // 454
		vec3(0.0553418, 0.0981934, 0.86024),  // 455
		vec3(0.0567734, 0.101031, 0.842031),  // 456
		vec3(0.0583973, 0.104229, 0.825572),  // 457
		vec3(0.0602409, 0.107814, 0.81086),  // 458
		vec3(0.0623353, 0.111817, 0.797902),  // 459
		vec3(0.0647164, 0.116272, 0.786704),  // 460
		vec3(0.0674131, 0.121204, 0.777119),  // 461
		vec3(0.070404, 0.126573, 0.768365),  // 462
		vec3(0.0736489, 0.132311, 0.759538),  // 463
		vec3(0.0770978, 0.138334, 0.749777),  // 464
		vec3(0.0806894, 0.144541, 0.738268),  // 465
		vec3(0.0843613, 0.150828, 0.724389),  // 466
		vec3(0.0880904, 0.157146, 0.708113),  // 467
		vec3(0.091863, 0.163457, 0.689572),  // 468
		vec3(0.0956637, 0.169721, 0.668927),  // 469
		vec3(0.0994755, 0.175893, 0.646359),  // 470
		vec3(0.103286, 0.181938, 0.622112),  // 471
		vec3(0.107103, 0.187872, 0.596591),  // 472
		vec3(0.110947, 0.193731, 0.570216),  // 473
		vec3(0.114838, 0.199557, 0.543373),  // 474
		vec3(0.118802, 0.205398, 0.516411),  // 475
		vec3(0.122863, 0.211302, 0.489647),  // 476
		vec3(0.127026, 0.217283, 0.463406),  // 477
		vec3(0.131293, 0.223347, 0.437965),  // 478
		vec3(0.135666, 0.229501, 0.413549),  // 479
		vec3(0.140145, 0.235754, 0.390333),  // 480
		vec3(0.144731, 0.242108, 0.368394),  // 481
		vec3(0.149415, 0.248545, 0.347582),  // 482
		vec3(0.154189, 0.255037, 0.327724),  // 483
		vec3(0.159038, 0.261554, 0.308676),  // 484
		vec3(0.163952, 0.268063, 0.290322),  // 485
		vec3(0.168932, 0.274561, 0.272626),  // 486
		vec3(0.174063, 0.28118, 0.255772),  // 487
		vec3(0.179457, 0.288097, 0.239945),  // 488
		vec3(0.185241, 0.295508, 0.22528),  // 489
		vec3(0.191556, 0.30363, 0.211867),  // 490
		vec3(0.198532, 0.312649, 0.199719),  // 491
		vec3(0.206182, 0.322565, 0.188674),  // 492
		vec3(0.214485, 0.333319, 0.178557),  // 493
		vec3(0.223411, 0.344844, 0.169217),  // 494
		vec3(0.232926, 0.357061, 0.160526),  // 495
		vec3(0.242992, 0.369895, 0.152368),  // 496
		vec3(0.253616, 0.383355, 0.14462),  // 497
		vec3(0.26481, 0.397467, 0.137173),  // 498
		vec3(0.276587, 0.41226, 0.129937),  // 499
		vec3(0.288959, 0.427764, 0.122839),  // 500
		vec3(0.301934, 0.444001, 0.115834),  // 501
		vec3(0.315508, 0.460947, 0.108922),  // 502
		vec3(0.329673, 0.478562, 0.102118),  // 503
		vec3(0.344416, 0.496795, 0.0954374),  // 504
		vec3(0.359716, 0.515587, 0.0888965),  // 505
		vec3(0.37555, 0.534868, 0.0825343),  // 506
		vec3(0.391895, 0.554575, 0.0764613),  // 507
		vec3(0.408722, 0.57464, 0.0707769),  // 508
		vec3(0.425998, 0.594984, 0.0655491),  // 509
		vec3(0.443683, 0.61552, 0.060821),  // 510
		vec3(0.461731, 0.636162, 0.0565919),  // 511
		vec3(0.480094, 0.656872, 0.0527659),  // 512
		vec3(0.498717, 0.677624, 0.049244),  // 513
		vec3(0.517539, 0.698393, 0.045947),  // 514
		vec3(0.536494, 0.719154, 0.0428123),  // 515
		vec3(0.555493, 0.739844, 0.0398014),  // 516
		vec3(0.574386, 0.760235, 0.0369227),  // 517
		vec3(0.592995, 0.780039, 0.0341909),  // 518
		vec3(0.611124, 0.798941, 0.0316158),  // 519
		vec3(0.628561, 0.81661, 0.0292033),  // 520
		vec3(0.645139, 0.832783, 0.0269536),  // 521
		vec3(0.660907, 0.84755, 0.0248575),  // 522
		vec3(0.675993, 0.861113, 0.0229047),  // 523
		vec3(0.690542, 0.873698, 0.0210855),  // 524
		vec3(0.70472, 0.88555, 0.0193912),  // 525
		vec3(0.718662, 0.896873, 0.0178145),  // 526
		vec3(0.732323, 0.907638, 0.0163514),  // 527
		vec3(0.745606, 0.917757, 0.014998),  // 528
		vec3(0.75841, 0.927137, 0.0137497),  // 529
		vec3(0.77063, 0.935687, 0.0126013),  // 530
		vec3(0.782208, 0.943362, 0.0115466),  // 531
		vec3(0.79329, 0.950309, 0.0105766),  // 532
		vec3(0.804084, 0.956733, 0.00968268),  // 533
		vec3(0.814813, 0.962844, 0.00885746),  // 534
		vec3(0.825711, 0.968858, 0.00809453),  // 535
		vec3(0.836943, 0.974919, 0.0073889),  // 536
		vec3(0.848349, 0.98085, 0.00673799),  // 537
		vec3(0.859676, 0.986388, 0.00613947),  // 538
		vec3(0.870656, 0.991267, 0.00559073),  // 539
		vec3(0.881011, 0.995217, 0.005089),  // 540
		vec3(0.890496, 0.998007, 0.0046312),  // 541
		vec3(0.899052, 0.999595, 0.00421366),  // 542
		vec3(0.906669, 0.999982, 0.00383286),  // 543
		vec3(0.913341, 0.999177, 0.00348559),  // 544
		vec3(0.919067, 0.997193, 0.00316893),  // 545
		vec3(0.923898, 0.994102, 0.00288021),  // 546
		vec3(0.928099, 0.990204, 0.00261698),  // 547
		vec3(0.931995, 0.985855, 0.00237701),  // 548
		vec3(0.935916, 0.981404, 0.00215829),  // 549
		vec3(0.940198, 0.977193, 0.00195896),  // 550
		vec3(0.945076, 0.973441, 0.00177737),  // 551
		vec3(0.950367, 0.969881, 0.00161218),  // 552
		vec3(0.955775, 0.966133, 0.00146215),  // 553
		vec3(0.961, 0.961823, 0.00132606),  // 554
		vec3(0.965733, 0.956583, 0.00120277),  // 555
		vec3(0.969744, 0.950167, 0.00109118),  // 556
		vec3(0.973133, 0.942773, 0.000990135),  // 557
		vec3(0.976086, 0.934709, 0.000898564),  // 558
		vec3(0.978793, 0.926271, 0.000815524),  // 559
		vec3(0.981445, 0.91775, 0.000740174),  // 560
		vec3(0.984186, 0.909339, 0.000671772),  // 561
		vec3(0.986965, 0.900895, 0.000609693),  // 562
		vec3(0.989678, 0.892197, 0.000553372),  // 563
		vec3(0.99222, 0.883035, 0.000502292),  // 564
		vec3(0.994486, 0.873205, 0.000455979),  // 565
		vec3(0.996386, 0.862565, 0.000413997),  // 566
		vec3(0.997895, 0.851173, 0.00037594),  // 567
		vec3(0.999004, 0.839132, 0.000341439),  // 568
		vec3(0.999706, 0.826545, 0.00031016),  // 569
		vec3(0.999993, 0.813509, 0.0002818),  // 570
		vec3(0.999837, 0.800082, 0.000256084),  // 571
		vec3(0.999123, 0.786166, 0.000232764),  // 572
		vec3(0.997719, 0.771635, 0.000211616),  // 573
		vec3(0.995491, 0.756376, 0.000192436),  // 574
		vec3(0.99231, 0.740291, 0.000175039),  // 575
		vec3(0.988146, 0.723369, 0.000159257),  // 576
		vec3(0.983345, 0.70589, 0.00014494),  // 577
		vec3(0.978342, 0.688184, 0.000131948),  // 578
		vec3(0.973564, 0.670554, 0.000120157),  // 579
		vec3(0.969429, 0.653274, 0.000109454),  // 580
		vec3(0.966211, 0.636524, 0.0000997367),  // 581
		vec3(0.96363, 0.620217, 0.0000909125),  // 582
		vec3(0.961273, 0.604211, 0.0000828976),  // 583
		vec3(0.958732, 0.588375, 0.000075616),  // 584
		vec3(0.955602, 0.572597, 0.0000689991),  // 585
		vec3(0.951569, 0.556783, 0.0000629846),  // 586
		vec3(0.946654, 0.540896, 0.0000575163),  // 587
		vec3(0.940962, 0.524912, 0.0000525432),  // 588
		vec3(0.9346, 0.508817, 0.0000480192),  // 589
		vec3(0.927673, 0.492599, 0.0000439024),  // 590
		vec3(0.920264, 0.476268, 0.0000401551),  // 591
		vec3(0.912391, 0.459893, 0.0000367431),  // 592
		vec3(0.90405, 0.443551, 0.0000336353),  // 593
		vec3(0.895243, 0.427314, 0.0000308037),  // 594
		vec3(0.885969, 0.411246, 0.0000282228),  // 595
		vec3(0.876242, 0.395396, 0.0000258697),  // 596
		vec3(0.866117, 0.379782, 0.0000237235),  // 597
		vec3(0.855658, 0.36441, 0.0000217653),  // 598
		vec3(0.844926, 0.349289, 0.0000199779),  // 599
		vec3(0.833982, 0.334429, 0.0000183459),  // 600
		vec3(0.822859, 0.319843, 0.0000168551),  // 601
		vec3(0.811491, 0.305564, 0.0000154929),  // 602
		vec3(0.799794, 0.291625, 0.0000142476),  // 603
		vec3(0.787689, 0.278053, 0.0000131087),  // 604
		vec3(0.775103, 0.264872, 0.0000120667),  // 605
		vec3(0.761996, 0.252099, 0.0000111131),  // 606
		vec3(0.748425, 0.239747, 0.0000102399),  // 607
		vec3(0.73447, 0.227822, 0.00000943999),  // 608
		vec3(0.720208, 0.21633, 0.00000870695),  // 609
		vec3(0.705713, 0.205273, 0.00000803488),  // 610
		vec3(0.691044, 0.19465, 0.00000741844),  // 611
		vec3(0.676212, 0.184448, 0.00000685279),  // 612
		vec3(0.66122, 0.174654, 0.00000633352),  // 613
		vec3(0.646072, 0.165256, 0.00000585662),  // 614
		vec3(0.630773, 0.156243, 0.00000541843),  // 615
		vec3(0.615349, 0.147602, 0),  // 616
		vec3(0.599888, 0.139329, 0),  // 617
		vec3(0.584489, 0.131416, 0),  // 618
		vec3(0.56924, 0.123856, 0),  // 619
		vec3(0.554224, 0.116641, 0),  // 620
		vec3(0.539469, 0.109766, 0),  // 621
		vec3(0.524827, 0.103226, 0),  // 622
		vec3(0.510124, 0.0970205, 0),  // 623
		vec3(0.495206, 0.091143, 0),  // 624
		vec3(0.479941, 0.0855872, 0),  // 625
		vec3(0.46427, 0.0803428, 0),  // 626
		vec3(0.448338, 0.0753913, 0),  // 627
		vec3(0.432329, 0.0707136, 0),  // 628
		vec3(0.416406, 0.0662924, 0),  // 629
		vec3(0.400711, 0.062112, 0),  // 630
		vec3(0.385355, 0.0581595, 0),  // 631
		vec3(0.370377, 0.0544276, 0),  // 632
		vec3(0.355793, 0.0509098, 0),  // 633
		vec3(0.341618, 0.0475991, 0),  // 634
		vec3(0.327864, 0.0444879, 0),  // 635
		vec3(0.314541, 0.0415659, 0),  // 636
		vec3(0.301662, 0.0388152, 0),  // 637
		vec3(0.289239, 0.0362181, 0),  // 638
		vec3(0.277278, 0.0337599, 0),  // 639
		vec3(0.265784, 0.0314282, 0),  // 640
		vec3(0.25474, 0.0292176, 0),  // 641
		vec3(0.244054, 0.0271403, 0),  // 642
		vec3(0.233634, 0.0252084, 0),  // 643
		vec3(0.223399, 0.0234286, 0),  // 644
		vec3(0.213284, 0.0218037, 0),  // 645
		vec3(0.203257, 0.0203285, 0),  // 646
		vec3(0.19337, 0.0189779, 0),  // 647
		vec3(0.183688, 0.0177272, 0),  // 648
		vec3(0.174263, 0.016556, 0),  // 649
		vec3(0.165141, 0.015448, 0),  // 650
		vec3(0.156354, 0.0143924, 0),  // 651
		vec3(0.147916, 0.0133896, 0),  // 652
		vec3(0.139834, 0.0124414, 0),  // 653
		vec3(0.132111, 0.0115488, 0),  // 654
		vec3(0.124749, 0.010712, 0),  // 655
		vec3(0.117744, 0.00992994, 0),  // 656
		vec3(0.111081, 0.00920057, 0),  // 657
		vec3(0.104747, 0.00852126, 0),  // 658
		vec3(0.0987277, 0.00788945, 0),  // 659
		vec3(0.0930085, 0.00730255, 0),  // 660
		vec3(0.0875769, 0.0067582, 0),  // 661
		vec3(0.0824219, 0.00625474, 0),  // 662
		vec3(0.0775328, 0.00579045, 0),  // 663
		vec3(0.0728989, 0.00536347, 0),  // 664
		vec3(0.06851, 0.00497179, 0),  // 665
		vec3(0.0643554, 0.004613, 0),  // 666
		vec3(0.0604242, 0.00428339, 0),  // 667
		vec3(0.0567057, 0.0039794, 0),  // 668
		vec3(0.0531896, 0.00369803, 0),  // 669
		vec3(0.0498661, 0.00343667, 0),  // 670
		vec3(0.0467258, 0.00319326, 0),  // 671
		vec3(0.0437598, 0.00296653, 0),  // 672
		vec3(0.0409594, 0.00275543, 0),  // 673
		vec3(0.0383165, 0.00255896, 0),  // 674
		vec3(0.0358233, 0.00237617, 0),  // 675
		vec3(0.0334725, 0.00220618, 0),  // 676
		vec3(0.0312583, 0.00204809, 0),  // 677
		vec3(0.0291751, 0.0019011, 0),  // 678
		vec3(0.0272173, 0.00176442, 0),  // 679
		vec3(0.025379, 0.00163734, 0),  // 680
		vec3(0.0236541, 0.00151916, 0),  // 681
		vec3(0.0220336, 0.00140913, 0),  // 682
		vec3(0.0205092, 0.00130655, 0),  // 683
		vec3(0.0190735, 0.00121078, 0),  // 684
		vec3(0.0177201, 0.00112128, 0),  // 685
		vec3(0.0164451, 0.00103766, 0),  // 686
		vec3(0.015251, 0.000959892, 0),  // 687
		vec3(0.0141404, 0.000887951, 0),  // 688
		vec3(0.0131137, 0.000821729, 0),  // 689
		vec3(0.0121701, 0.000761051, 0),  // 690
		vec3(0.0113063, 0.000705623, 0),  // 691
		vec3(0.0105131, 0.000654874, 0),  // 692
		vec3(0.00978127, 0.00060824, 0),  // 693
		vec3(0.009103, 0.00056524, 0),  // 694
		vec3(0.0084717, 0.000525457, 0),  // 695
		vec3(0.00788227, 0.00048855, 0),  // 696
		vec3(0.00733213, 0.000454277, 0),  // 697
		vec3(0.00681928, 0.000422436, 0),  // 698
		vec3(0.00634173, 0.000392839, 0),  // 699
		vec3(0.00589749, 0.000365317, 0),  // 700
		vec3(0.00548444, 0.00033971, 0),  // 701
		vec3(0.00509978, 0.000315856, 0),  // 702
		vec3(0.00474086, 0.000293607, 0),  // 703
		vec3(0.00440538, 0.000272834, 0),  // 704
		vec3(0.00409129, 0.000253417, 0),  // 705
		vec3(0.00379703, 0.000235265, 0),  // 706
		vec3(0.00352187, 0.000218331, 0),  // 707
		vec3(0.0032652, 0.000202574, 0),  // 708
		vec3(0.00302632, 0.000187948, 0),  // 709
		vec3(0.00280447, 0.000174402, 0),  // 710
		vec3(0.00259882, 0.000161878, 0),  // 711
		vec3(0.00240849, 0.000150305, 0),  // 712
		vec3(0.00223259, 0.000139612, 0),  // 713
		vec3(0.00207024, 0.000129734, 0),  // 714
		vec3(0.00192058, 0.000120608, 0),  // 715
		vec3(0.00178269, 0.000112176, 0),  // 716
		vec3(0.0016554, 0.000104373, 0),  // 717
		vec3(0.00153762, 0.0000971383, 0),  // 718
		vec3(0.00142839, 0.0000904202, 0),  // 719
		vec3(0.00132687, 0.0000841716, 0),  // 720
		vec3(0.00123238, 0.0000783538, 0),  // 721
		vec3(0.00114456, 0.0000729425, 0),  // 722
		vec3(0.00106308, 0.0000679164, 0),  // 723
		vec3(0.000987592, 0.0000632542, 0),  // 724
		vec3(0.000917777, 0.0000589349, 0),  // 725
		vec3(0.000853264, 0.000054936, 0),  // 726
		vec3(0.000793589, 0.0000512291, 0),  // 727
		vec3(0.000738306, 0.0000477872, 0),  // 728
		vec3(0.000687018, 0.0000445862, 0),  // 729
		vec3(0.000639373, 0.0000416049, 0),  // 730
		vec3(0.000595057, 0.0000388245, 0),  // 731
		vec3(0.000553797, 0.0000362302, 0),  // 732
		vec3(0.00051535, 0.0000338086, 0),  // 733
		vec3(0.000479496, 0.0000315474, 0),  // 734
		vec3(0.000446035, 0.0000294354, 0),  // 735
		vec3(0.000414809, 0.0000274634, 0),  // 736
		vec3(0.000385749, 0.0000256268, 0),  // 737
		vec3(0.000358792, 0.0000239217, 0),  // 738
		vec3(0.000333861, 0.0000223432, 0),  // 739
		vec3(0.000310869, 0.000020886, 0),  // 740
		vec3(0.000289699, 0.0000195424, 0),  // 741
		vec3(0.000270145, 0.000018299, 0),  // 742
		vec3(0.000252007, 0.0000171423, 0),  // 743
		vec3(0.000235117, 0.0000160611, 0),  // 744
		vec3(0.000219329, 0.0000150458, 0),  // 745
		vec3(0.000204535, 0.0000140893, 0),  // 746
		vec3(0.000190692, 0.0000131899, 0),  // 747
		vec3(0.000177771, 0.0000123462, 0),  // 748
		vec3(0.000165736, 0.0000115569, 0),  // 749
		vec3(0.000154549, 0.00001082, 0),  // 750
		vec3(0.000144167, 0.0000101334, 0),  // 751
		vec3(0.000134528, 0.00000949367, 0),  // 752
		vec3(0.000125574, 0.00000889736, 0),  // 753
		vec3(0.000117251, 0.00000834135, 0),  // 754
		vec3(0.000109508, 0.00000782271, 0),  // 755
		vec3(0.0001023, 0.00000733865, 0),  // 756
		vec3(0.0000955828, 0.00000688612, 0),  // 757
		vec3(0.0000893161, 0.00000646228, 0),  // 758
		vec3(0.0000834631, 0.00000606462, 0),  // 759
		vec3(0.0000779912, 0.00000569093, 0),  // 760
		vec3(0.000072873, 0.00000533942, 0),  // 761
		vec3(0.0000680921, 0.00000500929, 0),  // 762
		vec3(0.0000636342, 0.00000469984, 0),  // 763
		vec3(0.0000594841, 0.00000441034, 0),  // 764
		vec3(0.0000556264, 0.00000413998, 0),  // 765
		vec3(0.000052043, 0.00000388772, 0),  // 766
		vec3(0.0000487063, 0.00000365186, 0),  // 767
		vec3(0.00004559, 0.0000034307, 0),  // 768
		vec3(0.000042671, 0.00000322278, 0),  // 769
		vec3(0.0000399295, 0.00000302683, 0),  // 770
		vec3(0.0000373509, 0.00000284192, 0),  // 771
		vec3(0.0000349326, 0.00000266795, 0),  // 772
		vec3(0.000032673, 0.00000250491, 0),  // 773
		vec3(0.000030569, 0.00000235267, 0),  // 774
		vec3(0.0000286163, 0.000002211, 0),  // 775
		vec3(0.0000268077, 0.00000207946, 0),  // 776
		vec3(0.0000251286, 0.000001957, 0),  // 777
		vec3(0.0000235645, 0.00000184258, 0),  // 778
		vec3(0.0000221026, 0.00000173528, 0),  // 779
		vec3(0.0000207321, 0.00000163433, 0),  // 780
		vec3(0.0000194444, 0.0000015391, 0),  // 781
		vec3(0.0000182351, 0.00000144932, 0),  // 782
		vec3(0.0000171008, 0.00000136478, 0),  // 783
		vec3(0.000016038, 0.00000128526, 0),  // 784
		vec3(0.0000150432, 0.00000121054, 0),  // 785
		vec3(0.0000141127, 0.00000114038, 0),  // 786
		vec3(0.000013242, 0.00000107446, 0),  // 787
		vec3(0.0000124263, 0.00000101247, 0),  // 788
		vec3(0.0000116618, 0.00000095413, 0),  // 789
		vec3(0.0000109446, 0.00000089917, 0),  // 790
		vec3(0.0000102716, 0.000000847379, 0),  // 791
		vec3(0.00000964036, 0.000000798635, 0),  // 792
		vec3(0.00000904897, 0.000000752832, 0),  // 793
		vec3(0.00000849535, 0.000000709857, 0),  // 794
		vec3(0.0000079775, 0.000000669594, 0),  // 795
		vec3(0.00000749341, 0.000000631907, 0),  // 796
		vec3(0.00000704079, 0.000000596604, 0),  // 797
		vec3(0.00000661744, 0.000000563495, 0),  // 798
		vec3(0.00000622133, 0.000000532408, 0),  // 799
		vec3(0.00000585057, 0.000000503187, 0),  // 800
		vec3(0.00000550333, 0.000000475686, 0),  // 801
		vec3(0.00000517756, 0.000000449753, 0),  // 802
		vec3(0.00000487135, 0.000000425249, 0),  // 803
		vec3(0.000004583, 0.00000040205, 0),  // 804
		vec3(0.00000431102, 0.000000380046, 0),  // 805
		vec3(0.00000405422, 0.000000359156, 0),  // 806
		vec3(0.00000381213, 0.000000339356, 0),  // 807
		vec3(0.00000358438, 0.000000320633, 0),  // 808
		vec3(0.00000337053, 0.000000302966, 0),  // 809
		vec3(0.00000317009, 0.000000286329, 0),  // 810
		vec3(0.00000298248, 0.000000270687, 0),  // 811
		vec3(0.00000280691, 0.00000025598, 0),  // 812
		vec3(0.00000264257, 0.000000242147, 0),  // 813
		vec3(0.00000248873, 0.00000022913, 0),  // 814
		vec3(0.00000234468, 0.000000216878, 0),  // 815
		vec3(0.00000220974, 0.000000205338, 0),  // 816
		vec3(0.00000208315, 0.000000194449, 0),  // 817
		vec3(0.00000196419, 0.000000184155, 0),  // 818
		vec3(0.00000185222, 0.000000174407, 0),  // 819
		vec3(0.00000174666, 0.000000165158, 0),  // 820
		vec3(0.00000164705, 0.000000156373, 0),  // 821
		vec3(0.00000155307, 0.000000148031, 0),  // 822
		vec3(0.00000146448, 0.000000140117, 0),  // 823
		vec3(0.000001381, 0.000000132615, 0),  // 824
		vec3(0.00000130241, 0.000000125508, 0),  // 825
		vec3(0.00000122844, 0.000000118781, 0),  // 826
		vec3(0.00000115888, 0.000000112416, 0),  // 827
		vec3(0.00000109348, 0.000000106398, 0),  // 828
		vec3(0.00000103203, 0.000000100711, 0),  // 829
		vec3(0.000000974306, 0.0000000953411, 0),  // 830
		vec3(0.00474086, 0.000293607, 0),  // 703
		vec3(0.000415003, 0.000368349, 0.00954729)  // 390
	);


// Transformation of 2-deg cone fundamentals to XYZ color space,
// taken from http://www.cvrl.org/database/text/cienewxyz/cie2012xyz2.htm
mat3 lms2xyz =
	mat3(
		1.94735469, -1.41445123, 0.36476327,
		0.68990272, 0.34832189, 0,
		0, 0, 1.93485343
	);


out gl_PerVertex {
	vec4 gl_Position;
};

layout(location = 0) out vec3 outColor;


void main()
{
	// convert LMS to XYZ color space
	vec3 xyz = lms[gl_VertexIndex].xyz * lms2xyz;

	// convert XYZ to x,y chromacity coordinates
	float s = xyz.x + xyz.y + xyz.z;
	float chx = xyz.x / s;
	float chy = xyz.y / s;

	// vertex screen position
	gl_Position = vec4(chx*2-1, -chy*2+1, 0.5, 1.0);

	// pseudo-color
	outColor.r = clamp((chx-0.167)/(0.724-0.167), 0, 1);
	outColor.g = clamp((chy-(0.277*outColor.r))/(0.841-(0.27*outColor.r)), 0, 1);
	outColor.b = clamp(1 - outColor.r - outColor.g, 0, 1);
}
